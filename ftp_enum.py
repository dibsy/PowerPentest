#

# All the services along with their port number are maintained in a dictionary
import sys
from ftplib import FTP
def ftp_enum():
	ip = raw_input("Enter ftp address or ip:")
	try:
		print "[+]Starting FTP Enumeration at "+ip 
		ftp = FTP(ip)
		print "FTP port at 21 seems to be open"
		print "\n"
		
		print "[+]Trying to grab banner"
		msg = ftp.getwelcome()
		print "Received Banner:"+msg
		print "\n"
		
		print "[+]Trying annonymous login"
		msg = ftp.login()
		if '230 Login successful' in msg:
			print "Annonymous Login Allowed"
		print "\n"
		
		print "[+]Trying directory listing"
		dirs = []
		ftp.dir(dirs.append)
		if not dirs:
			print "Sorry. No directories or Directory Listing is not allowed" 
		else:
			for x in dirs: 
				print x

		print "[+]Closing connection"
		ftp.quit()
	except:
		e=sys.exc_info()[1]
		print "Error:"+str(e)

